---
openapi: 3.0.1
info:
  title: API Iume Owner
  version: v1
  description: Owner endpoints
paths:
  "/v1/owners/emails":
    get:
      summary: show email
      tags:
      - Emails
      parameters:
      - name: email
        in: query
        schema:
          type: string
      security:
      - bearer: []
      responses:
        '200':
          description: email found
          content: {}
        '404':
          description: email not found
          content: {}
        '422':
          description: when email is blank
          content:
            application/json:
              schema:
                type: object
                properties:
                  email:
                    type: array
                    items:
                      type: string
                      example: não pode ser vázio
  "/v1/owners/feedbacks":
    post:
      summary: create feedback
      tags:
      - Feedbacks
      security:
      - bearer: []
      parameters: []
      responses:
        '201':
          description: created success
          content:
            application/json:
              schema:
                type: object
                properties:
                  id:
                    type: string
                  type:
                    type: string
                    exemple: feedbacks
                  attributes:
                    type: object
                    properties:
                      screen:
                        type: screen
                        example: home
                      body:
                        type: string
        '422':
          description: created success
          content:
            application/json:
              schema:
                type: object
                properties:
                  body:
                    type: array
                    items:
                      type: string
                      example: não pode ser vázio
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                feedback:
                  type: object
                  properties:
                    screen:
                      type: string
                      example: Home
                    body:
                      type: string
                      example: Aliquid tempora sunt voluptas eius nihil fugit iure
                        voluptatum quidem?
              required:
              - body
  "/v1/owners/restaurants/sections/{section_id}/products":
    get:
      summary: get all products of a section
      tags:
      - Products
      security:
      - bearer: []
      parameters:
      - name: section_id
        in: path
        required: true
        schema:
          type: string
      - name: q
        in: query
        required: false
        schema:
          type: object
          properties:
            q[s]:
              type: string
              example: name+desc
      responses:
        '200':
          description: product array
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: array
                    items:
                      "$ref": "#/components/schemas/product"
    post:
      summary: create product
      tags:
      - Products
      security:
      - bearer: []
      parameters:
      - name: section_id
        in: path
        required: true
        schema:
          type: string
      responses:
        '201':
          description: create success
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    "$ref": "#/components/schemas/product"
        '422':
          description: create fail
          content:
            application/json:
              schema:
                type: object
                properties:
                  name:
                    type: array
                    items:
                      type: string
                      example: não pode ser vázio
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                product:
                  type: object
                  properties:
                    name:
                      type: string
                      example: da Penha, de Quadros e Aragão
                    description:
                      type: string
                      example: Porro ad maxime. Occaecati alias sed. Sunt et quia.
                        Eos ea quisquam. Odit ullam autem. Fugiat volup.
                    image:
                      type: object
                      properties:
                        data:
                          type: string
                          description: Only base64 date
                          example: data:image/jpeg;base64,/9j/4RiDRXhpZgAATU0AKgA...
                    price:
                      type: integer
                      example: '10.0'
                    active:
                      type: boolean
                  required:
                  - name
                  - price
                  - active
  "/v1/owners/restaurants/sections/{section_id}/products/{id}":
    get:
      summary: show product
      tags:
      - Products
      security:
      - bearer: []
      parameters:
      - name: section_id
        in: path
        required: true
        schema:
          type: string
      - name: id
        in: path
        required: true
        schema:
          type: integer
      responses:
        '200':
          description: product found
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    "$ref": "#/components/schemas/product"
        '401':
          description: Not autorization
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    "$ref": "#/components/schemas/product"
    put:
      summary: update product
      tags:
      - Products
      security:
      - bearer: []
      description: Use image_destroy only if you need delete image
      parameters:
      - name: section_id
        in: path
        required: true
        schema:
          type: string
      - name: id
        in: path
        required: true
        schema:
          type: string
      responses:
        '202':
          description: update remove image
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    "$ref": "#/components/schemas/product"
        '422':
          description: update fail
          content:
            application/json:
              schema:
                type: object
                properties:
                  name:
                    type: array
                    items:
                      type: string
                      example: não pode ser vázio
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                product:
                  type: object
                  properties:
                    name:
                      type: string
                      example: da Maia e Associados
                    description:
                      type: string
                      example: Quo autem odio. Debitis adipisci sapiente. Totam ducimus
                        consequatur. Iste laudantium laborum. Repe.
                    image:
                      type: object
                      properties:
                        data:
                          type: string
                          description: Only base64 date
                          example: data:image/jpeg;base64,/9j/4RiDRXhpZgAATU0AKgA...
                    price:
                      type: integer
                      example: '10.0'
                    active:
                      type: boolean
                    image_destroy:
                      type: boolean
                      description: If you need delete image
                  required:
                  - name
                  - price
                  - active
    delete:
      summary: Delete product
      tags:
      - Products
      security:
      - bearer: []
      parameters:
      - name: section_id
        in: path
        required: true
        schema:
          type: string
      - name: id
        in: path
        required: true
        schema:
          type: integer
      responses:
        '204':
          description: destroy success
          content: {}
  "/v1/owners/restaurants/sections/{section_id}/products/sort":
    put:
      summary: update sorts
      tags:
      - Products
      description: Owner can reorder position of products
      security:
      - bearer: []
      parameters:
      - name: section_id
        in: path
        required: true
        schema:
          type: string
      responses:
        '202':
          description: update positions
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: array
                    items:
                      "$ref": "#/components/schemas/product"
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                product:
                  type: object
                  properties:
                    ids:
                      type: array
                      example:
                      - 1
                      - 2
                      - 3
                      - 4
                      - 5
                  required:
                  - ids
  "/v1/owners/restaurants/{restaurant_id}/sections":
    get:
      summary: get all sections of a restaurant
      tags:
      - Sections
      security:
      - bearer: []
      parameters:
      - name: restaurant_id
        in: path
        required: true
        schema:
          type: string
      responses:
        '200':
          description: sections array
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: array
                    items:
                      "$ref": "#/components/schemas/section"
    post:
      summary: create section
      tags:
      - Sections
      security:
      - bearer: []
      parameters:
      - name: restaurant_id
        in: path
        required: true
        schema:
          type: string
      responses:
        '201':
          description: create success
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    "$ref": "#/components/schemas/section"
        '422':
          description: create fail
          content:
            application/json:
              schema:
                type: object
                properties:
                  name:
                    type: array
                    items:
                      type: string
                      example: não pode ser vázio
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                section:
                  type: object
                  properties:
                    name:
                      type: string
                      example: Reis, Louzada e Almeida
                    position:
                      type: integer
                      example: 1
                    active:
                      type: boolean
              required:
              - name
              - active
  "/v1/owners/restaurants/{restaurant_id}/sections/{id}":
    get:
      summary: show section
      tags:
      - Sections
      security:
      - bearer: []
      parameters:
      - name: restaurant_id
        in: path
        required: true
        schema:
          type: string
      - name: id
        in: path
        required: true
        schema:
          type: integer
      responses:
        '200':
          description: section found
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    "$ref": "#/components/schemas/section"
        '404':
          description: section not found
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    "$ref": "#/components/schemas/section"
    put:
      summary: update section
      tags:
      - Sections
      security:
      - bearer: []
      parameters:
      - name: restaurant_id
        in: path
        required: true
        schema:
          type: string
      - name: id
        in: path
        required: true
        schema:
          type: integer
      responses:
        '202':
          description: update success
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    "$ref": "#/components/schemas/section"
        '422':
          description: update fail
          content:
            application/json:
              schema:
                type: object
                properties:
                  name:
                    type: array
                    items:
                      type: string
                      example: não pode ser vázio
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                section:
                  type: object
                  properties:
                    name:
                      type: string
                      example: da Terra EIRELI
                    position:
                      type: integer
                      example: 1
                    active:
                      type: boolean
              required:
              - name
              - active
    delete:
      summary: Delete section
      tags:
      - Sections
      security:
      - bearer: []
      parameters:
      - name: restaurant_id
        in: path
        required: true
        schema:
          type: string
      - name: id
        in: path
        required: true
        schema:
          type: integer
      responses:
        '204':
          description: destroy success
          content: {}
  "/v1/owners/restaurants/{restaurant_id}/sections/sort":
    put:
      summary: update sorts
      tags:
      - Sections
      description: Owner can reorder position of sections
      security:
      - bearer: []
      parameters:
      - name: restaurant_id
        in: path
        required: true
        schema:
          type: string
      responses:
        '202':
          description: update positions
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: array
                    items:
                      "$ref": "#/components/schemas/section"
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                section:
                  type: object
                  properties:
                    ids:
                      type: array
                      example:
                      - 1
                      - 2
                      - 3
                      - 4
                      - 5
              required:
              - ids
  "/v1/owners/restaurants":
    post:
      summary: Create
      tags:
      - Restaurants
      security:
      - bearer: []
      parameters: []
      responses:
        '201':
          description: create restaurant
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    "$ref": "#/components/schemas/restaurant"
        '422':
          description: create failt
          content:
            application/json:
              schema:
                type: object
                properties:
                  name:
                    type: array
                    items:
                      type: string
                      example: não pode ser vázio
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                restaurant:
                  type: object
                  properties:
                    name:
                      type: string
                      example: da Fontoura, Batista e da Rocha
                    active:
                      type: boolean
              required:
              - name
              - active
    get:
      summary: All restaurants
      tags:
      - Restaurants
      security:
      - bearer: []
      responses:
        '200':
          description: return array
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: array
                    items:
                      "$ref": "#/components/schemas/restaurant"
  "/v1/owners/restaurants/{id}":
    put:
      summary: update restaurant
      tags:
      - Restaurants
      security:
      - bearer: []
      parameters:
      - name: id
        in: path
        required: true
        schema:
          type: string
      responses:
        '202':
          description: update success
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    "$ref": "#/components/schemas/restaurant"
                  included:
                    type: array
                    items:
                      "$ref": "#/components/schemas/phone"
        '422':
          description: create failt
          content:
            application/json:
              schema:
                type: object
                properties:
                  name:
                    type: array
                    items:
                      type: string
                      example: não pode ser vázio
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                restaurant:
                  type: object
                  properties:
                    name:
                      type: string
                      example: da Cruz-Macieira
                    active:
                      type: boolean
                    phones_attributes:
                      type: array
                      items:
                        type: object
                      example:
                      - number: 11-9999-9999
                      - id: 1
                        number: 11-9999-9999
                      - id: 2
                        _destroy: true
              required:
              - name
              - active
    get:
      summary: show restaurant
      tags:
      - Restaurants
      security:
      - bearer: []
      parameters:
      - name: id
        in: path
        required: true
        schema:
          type: string
      responses:
        '200':
          description: found
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    "$ref": "#/components/schemas/restaurant"
        '404':
          description: not found
          content: {}
  "/v1/owners/restaurants/availability_slug":
    put:
      summary: check slug availability
      tags:
      - Restaurants
      security:
      - bearer: []
      parameters: []
      responses:
        '202':
          description: availability
          content: {}
        '422':
          description: availability
          content:
            application/json:
              schema:
                type: object
                properties:
                  slug:
                    type: array
                    items:
                      type: string
                      example:
                      - já está em uso
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                restaurant:
                  type: object
                  properties:
                    slug:
                      type: string
                      example: repellat-voluptatum
              required:
              - name
              - active
  "/v1/owners/sessions":
    post:
      summary: Login
      tags:
      - Sessions
      parameters: []
      responses:
        '201':
          description: login success
          content:
            application/json:
              schema:
                type: object
                properties:
                  token:
                    type: string
                    example: xxxxx
                required:
                - token
        '422':
          description: login fail
          content:
            application/json:
              schema:
                type: object
                properties:
                  password:
                    type: array
                    items:
                      type: string
                      example: Senha incorreta
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                login:
                  type: object
                  properties:
                    email:
                      type: string
                      example: andreas@dickinson.com
                    password:
                      type: string
                      example: '12345678'
              required:
              - email
              - password
  "/v1/owners/sessions/me":
    delete:
      summary: Destroy session
      tags:
      - Sessions
      security:
      - bearer: []
      responses:
        '204':
          description: login success
          content: {}
        '401':
          description: when owner is not logged in
          content: {}
  "/v1/owners":
    post:
      summary: Creates a owner
      tags:
      - Owners
      parameters: []
      responses:
        '201':
          description: owner created
          content:
            application/json:
              schema:
                type: object
                properties:
                  token:
                    type: string
                    example: xxxxx
                required:
                - token
        '422':
          description: owner created fail
          content:
            application/json:
              schema:
                type: object
                properties:
                  email:
                    type: array
                    items:
                      type: string
                      example: Email inválido
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                owner:
                  type: object
                  properties:
                    email:
                      type: string
                      example: lon.collier@cassin.co
                    password:
                      type: string
                      example: '12345678'
                    password_confirmation:
                      type: string
                      example: '12345678'
              required:
              - email
              - password
              - password_confirmation
  "/v1/owners/me":
    get:
      summary: Show me
      tags:
      - Owners
      security:
      - bearer: []
      responses:
        '200':
          description: get me
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    "$ref": "#/components/schemas/owner"
    put:
      summary: Update me
      tags:
      - Owners
      security:
      - bearer: []
      description: to update email or password the current password is required ...
        use the password_current field
      parameters: []
      responses:
        '202':
          description: update email
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    "$ref": "#/components/schemas/owner"
        '422':
          description: owner update fail
          content:
            application/json:
              schema:
                type: object
                properties:
                  email:
                    type: array
                    items:
                      type: string
                      example: não pode ser vázio
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                owner:
                  type: object
                  properties:
                    email:
                      type: string
                      example: elidia@jerde.net
                    password:
                      type: string
                      example: '12345678'
                    password_confirmation:
                      type: string
                      example: '12345678'
                    password_current:
                      type: string
                      example: '12345678'
                      description: Only needed to update sensitive data
                  required:
                  - email
    delete:
      summary: Delete me
      tags:
      - Owners
      security:
      - bearer: []
      responses:
        '204':
          description: destroy success
          content: {}
  "/v1/recover_password/{model}":
    post:
      summary: ''
      tags:
      - RecoverPassword
      parameters:
      - name: model
        in: path
        example: owner
        required: true
        schema:
          type: string
      responses:
        '201':
          description: send request update password
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Confira sua caixa de email
        '422':
          description: when model not found
          content:
            application/json:
              schema:
                type: object
                properties:
                  errors:
                    type: object
                    properties:
                      email:
                        type: string
                        example: Email não encontrado
        '404':
          description: not found model
          content: {}
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                recover:
                  type: object
                  properties:
                    email:
                      type: string
                      example: alaine_reichel@beier.net
                  required:
                  - email
  "/v1/recover_password/{model}/{id}":
    put:
      summary: when update password
      tags:
      - RecoverPassword
      security:
      - bearer: []
      parameters:
      - name: model
        in: path
        example: owner
        required: true
        schema:
          type: string
      - name: id
        in: path
        example: me
        required: true
        schema:
          type: string
      responses:
        '202':
          description: update success
          content: {}
        '422':
          description: update fail
          content:
            application/json:
              schema:
                type: object
                properties:
                  password_confirmation:
                    type: array
                    items:
                      type: string
                      example: não corresponde Password
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                recover:
                  type: object
                  properties:
                    password:
                      type: string
                      example: '12345678'
                    password_con:
                      type: string
                      example: '12345678'
                  required:
                  - password
                  - password_confirmation
components:
  schemas:
    phone:
      type: object
      properties:
        id:
          type: string
          example: '1'
        type:
          type: string
          example: phones
        attributes:
          type: object
          properties:
            number:
              type: string
    owner:
      type: object
      properties:
        id:
          type: string
          example: '1'
        type:
          type: string
          example: owners
        attributes:
          type: object
          properties:
            email:
              type: string
              example: ena_kling@simonis.biz
            name:
              type: string
              nullable: true
            login_count:
              type: integer
              example: 1
            created_at:
              type: string
              example: '2020-09-19 12:36:19 -0300'
            updated_at:
              type: string
              example: '2020-09-19 12:36:19 -0300'
          required:
          - email
          - login_count
    product:
      type: object
      properties:
        id:
          type: string
          example: '1'
        type:
          type: string
          example: products
        attributes:
          type: object
          properties:
            price:
              type: string
              example: '10.0'
            name:
              type: string
              example: Caprese Salad
            description:
              type: string
              example: Our Mission at Denny’s is to establish beneficial business
                relationships with diverse suppliers who share our commitment to customer
                service, quality and competitive pricing.
              nullable: true
            position:
              type: integer
              example: 0
              nullable: true
            active:
              type: boolean
            image:
              type: object
              nullable: true
              properties:
                original:
                  type: string
                  example: https://loremflickr.com/300/300
                small:
                  type: string
                  example: https://loremflickr.com/300/300
          required:
          - price
          - name
    section:
      type: object
      properties:
        id:
          type: string
        type:
          type: string
          example: sections
        attributes:
          type: object
          properties:
            name:
              type: string
              example: Drinks
            position:
              type: integer
              example: 1
            active:
              type: boolean
    restaurant:
      type: object
      properties:
        type:
          type: string
          example: restaurants
        id:
          type: string
        attributes:
          type: object
          properties:
            name:
              type: string
            slug:
              type: string
            products_remaining:
              type: integer
              example: 1
            active:
              type: boolean
          required:
          - name
          - slug
          - active
        relationships:
          type: object
          properties:
            sections:
              type: object
              properties:
                data:
                  type: array
                  items:
                    properties:
                      id:
                        type: string
                      type:
                        type: string
                        example: phones
  securitySchemes:
    bearer:
      type: http
      scheme: bearer
servers:
- url: http://localhost:3000
  variables:
    defaultHost:
      default: http://localhost:3000
- url: https://imenu-dev.herokuapp.com
  variables:
    defaultHost:
      default: https://imenu-dev.herokuapp.com
- url: https://iume-api-stage.herokuapp.com
  variables:
    defaultHost:
      default: https://iume-api-stage.herokuapp.com

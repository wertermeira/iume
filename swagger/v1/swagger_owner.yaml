---
openapi: 3.0.1
info:
  title: API Iume Owner
  version: v1
  description: Owner endpoints
paths:
  "/v1/owners/emails":
    get:
      summary: show email
      tags:
      - Emails
      parameters:
      - name: email
        in: query
        schema:
          type: string
      security:
      - bearer: []
      responses:
        '200':
          description: email found
          content: {}
        '404':
          description: email not found
          content: {}
        '422':
          description: when email is blank
          content:
            application/json:
              schema:
                type: object
                properties:
                  email:
                    type: array
                    items:
                      type: string
                      example: não pode ser vázio
  "/v1/owners/feedbacks":
    post:
      summary: create feedback
      tags:
      - Feedbacks
      security:
      - bearer: []
      parameters: []
      responses:
        '201':
          description: created success
          content:
            application/json:
              schema:
                type: object
                properties:
                  id:
                    type: string
                  type:
                    type: string
                    exemple: feedbacks
                  attributes:
                    type: object
                    properties:
                      screen:
                        type: screen
                        example: home
                      body:
                        type: string
        '422':
          description: created success
          content:
            application/json:
              schema:
                type: object
                properties:
                  body:
                    type: array
                    items:
                      type: string
                      example: não pode ser vázio
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                feedback:
                  type: object
                  properties:
                    screen:
                      type: string
                      example: Home
                    body:
                      type: string
                      example: Fuga est aut ipsam rem exercitationem ratione fugiat
                        temporibus vel?
              required:
              - body
  "/v1/owners/restaurants/sections/{section_id}/products":
    get:
      summary: get all products of a section
      tags:
      - Products
      security:
      - bearer: []
      parameters:
      - name: section_id
        in: path
        required: true
        schema:
          type: string
      - name: q
        in: query
        required: false
        schema:
          type: object
          properties:
            q[s]:
              type: string
              example: name+desc
      responses:
        '200':
          description: product array
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: array
                    items:
                      "$ref": "#/components/schemas/product"
    post:
      summary: create product
      tags:
      - Products
      security:
      - bearer: []
      parameters:
      - name: section_id
        in: path
        required: true
        schema:
          type: string
      responses:
        '201':
          description: create success
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    "$ref": "#/components/schemas/product"
        '422':
          description: create fail
          content:
            application/json:
              schema:
                type: object
                properties:
                  name:
                    type: array
                    items:
                      type: string
                      example: não pode ser vázio
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                product:
                  type: object
                  properties:
                    name:
                      type: string
                      example: Godinho LTDA
                    description:
                      type: string
                      example: Ipsum quos sunt. Odit maxime facere. Officia facilis
                        nisi. Doloribus voluptatem quidem. Quia eum su.
                    image:
                      type: object
                      properties:
                        data:
                          type: string
                          description: Only base64 date
                          example: data:image/jpeg;base64,/9j/4RiDRXhpZgAATU0AKgA...
                    price:
                      type: integer
                      example: '10.0'
                    active:
                      type: boolean
                  required:
                  - name
                  - price
                  - active
  "/v1/owners/restaurants/sections/{section_id}/products/{id}":
    get:
      summary: show product
      tags:
      - Products
      security:
      - bearer: []
      parameters:
      - name: section_id
        in: path
        required: true
        schema:
          type: string
      - name: id
        in: path
        required: true
        schema:
          type: integer
      responses:
        '200':
          description: product found
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    "$ref": "#/components/schemas/product"
        '401':
          description: Not autorization
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    "$ref": "#/components/schemas/product"
    put:
      summary: update product
      tags:
      - Products
      security:
      - bearer: []
      description: Use image_destroy only if you need delete image
      parameters:
      - name: section_id
        in: path
        required: true
        schema:
          type: string
      - name: id
        in: path
        required: true
        schema:
          type: string
      responses:
        '202':
          description: update remove image
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    "$ref": "#/components/schemas/product"
        '422':
          description: update fail
          content:
            application/json:
              schema:
                type: object
                properties:
                  name:
                    type: array
                    items:
                      type: string
                      example: não pode ser vázio
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                product:
                  type: object
                  properties:
                    name:
                      type: string
                      example: Nunes-Guterres
                    description:
                      type: string
                      example: Repellat libero consequatur. Incidunt voluptatibus
                        et. Rem qui repellat. Consequuntur eaque numquam.
                    image:
                      type: object
                      properties:
                        data:
                          type: string
                          description: Only base64 date
                          example: data:image/jpeg;base64,/9j/4RiDRXhpZgAATU0AKgA...
                    price:
                      type: integer
                      example: '10.0'
                    active:
                      type: boolean
                    image_destroy:
                      type: boolean
                      description: If you need delete image
                  required:
                  - name
                  - price
                  - active
    delete:
      summary: Delete product
      tags:
      - Products
      security:
      - bearer: []
      parameters:
      - name: section_id
        in: path
        required: true
        schema:
          type: string
      - name: id
        in: path
        required: true
        schema:
          type: integer
      responses:
        '204':
          description: destroy success
          content: {}
  "/v1/owners/restaurants/sections/{section_id}/products/sort":
    put:
      summary: update sorts
      tags:
      - Products
      description: Owner can reorder position of products
      security:
      - bearer: []
      parameters:
      - name: section_id
        in: path
        required: true
        schema:
          type: string
      responses:
        '202':
          description: update positions
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: array
                    items:
                      "$ref": "#/components/schemas/product"
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                product:
                  type: object
                  properties:
                    ids:
                      type: array
                      example:
                      - 1
                      - 2
                      - 3
                      - 4
                      - 5
                  required:
                  - ids
  "/v1/owners/restaurants/{restaurant_id}/sections":
    get:
      summary: get all sections of a restaurant
      tags:
      - Sections
      security:
      - bearer: []
      parameters:
      - name: restaurant_id
        in: path
        required: true
        schema:
          type: string
      responses:
        '200':
          description: sections array
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: array
                    items:
                      "$ref": "#/components/schemas/section"
    post:
      summary: create section
      tags:
      - Sections
      security:
      - bearer: []
      parameters:
      - name: restaurant_id
        in: path
        required: true
        schema:
          type: string
      responses:
        '201':
          description: create success
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    "$ref": "#/components/schemas/section"
        '422':
          description: create fail
          content:
            application/json:
              schema:
                type: object
                properties:
                  name:
                    type: array
                    items:
                      type: string
                      example: não pode ser vázio
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                section:
                  type: object
                  properties:
                    name:
                      type: string
                      example: Cerqueira, Regueira e Aroeira
                    position:
                      type: integer
                      example: 1
                    active:
                      type: boolean
              required:
              - name
              - active
  "/v1/owners/restaurants/{restaurant_id}/sections/{id}":
    get:
      summary: show section
      tags:
      - Sections
      security:
      - bearer: []
      parameters:
      - name: restaurant_id
        in: path
        required: true
        schema:
          type: string
      - name: id
        in: path
        required: true
        schema:
          type: integer
      responses:
        '200':
          description: section found
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    "$ref": "#/components/schemas/section"
        '404':
          description: section not found
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    "$ref": "#/components/schemas/section"
    put:
      summary: update section
      tags:
      - Sections
      security:
      - bearer: []
      parameters:
      - name: restaurant_id
        in: path
        required: true
        schema:
          type: string
      - name: id
        in: path
        required: true
        schema:
          type: integer
      responses:
        '202':
          description: update success
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    "$ref": "#/components/schemas/section"
        '422':
          description: update fail
          content:
            application/json:
              schema:
                type: object
                properties:
                  name:
                    type: array
                    items:
                      type: string
                      example: não pode ser vázio
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                section:
                  type: object
                  properties:
                    name:
                      type: string
                      example: Araújo-Paes
                    position:
                      type: integer
                      example: 1
                    active:
                      type: boolean
              required:
              - name
              - active
    delete:
      summary: Delete section
      tags:
      - Sections
      security:
      - bearer: []
      parameters:
      - name: restaurant_id
        in: path
        required: true
        schema:
          type: string
      - name: id
        in: path
        required: true
        schema:
          type: integer
      responses:
        '204':
          description: destroy success
          content: {}
  "/v1/owners/restaurants/{restaurant_id}/sections/sort":
    put:
      summary: update sorts
      tags:
      - Sections
      description: Owner can reorder position of sections
      security:
      - bearer: []
      parameters:
      - name: restaurant_id
        in: path
        required: true
        schema:
          type: string
      responses:
        '202':
          description: update positions
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: array
                    items:
                      "$ref": "#/components/schemas/section"
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                section:
                  type: object
                  properties:
                    ids:
                      type: array
                      example:
                      - 1
                      - 2
                      - 3
                      - 4
                      - 5
              required:
              - ids
  "/v1/owners/restaurants/{restaurant_id}/tools/whatsapp":
    get:
      summary: show whatsapp
      tags:
      - ToolsWhatsapp
      security:
      - bearer: []
      parameters:
      - name: restaurant_id
        in: path
        required: true
        schema:
          type: string
      - name: included
        in: query
        required: false
        example: phone,phone.restaurant
        schema:
          type: string
      responses:
        '200':
          description: show ToolWhatsapp
          content:
            application/json:
              schema:
                "$ref": "#/components/schemas/tools_whatsapp"
        '204':
          description: no content
          content: {}
    put:
      summary: Update whatsapp
      tags:
      - ToolsWhatsapp
      security:
      - bearer: []
      description: To activate this option, the restaurant must have an address
      parameters:
      - name: restaurant_id
        in: path
        required: true
        schema:
          type: string
      - name: included
        in: query
        required: false
        example: phone,phone.restaurant
        schema:
          type: string
      responses:
        '202':
          description: update whatsapp
          content:
            application/json:
              schema:
                "$ref": "#/components/schemas/tools_whatsapp"
        '422':
          description: update whatsapp fail
          content:
            application/json:
              schema:
                type: object
                properties:
                  phone_id:
                    type: array
                    items:
                      type: string
                      example: é inválido
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                whatsapp:
                  type: object
                  properties:
                    phone_id:
                      type: integer
                      example: '1'
                    active:
                      type: boolean
                  required:
                  - phone_id
  "/v1/owners/restaurants":
    post:
      summary: Create
      tags:
      - Restaurants
      security:
      - bearer: []
      parameters: []
      responses:
        '201':
          description: create restaurant
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    "$ref": "#/components/schemas/restaurant"
        '422':
          description: create failt
          content:
            application/json:
              schema:
                type: object
                properties:
                  name:
                    type: array
                    items:
                      type: string
                      example: não pode ser vázio
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                restaurant:
                  type: object
                  properties:
                    name:
                      type: string
                      example: Ramires-Arantes
                    active:
                      type: boolean
              required:
              - name
              - active
    get:
      summary: All restaurants
      tags:
      - Restaurants
      security:
      - bearer: []
      parameters:
      - name: included
        in: query
        required: false
        example: phones,address,address.city,address.city.state
        schema:
          type: string
      responses:
        '200':
          description: return array
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: array
                    items:
                      "$ref": "#/components/schemas/restaurant"
  "/v1/owners/restaurants/{id}":
    put:
      summary: update restaurant
      tags:
      - Restaurants
      security:
      - bearer: []
      parameters:
      - name: id
        in: path
        required: true
        schema:
          type: string
      responses:
        '202':
          description: update success
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    "$ref": "#/components/schemas/restaurant"
                  included:
                    type: array
                    items:
                      "$ref": "#/components/schemas/phone"
                      type: object
                    example:
                    - id: '1'
                      type: phones
                      attributes:
                        number: 11-9999-9999
                    - id: '1'
                      type: addresses
                      attributes:
                        street: Marginal Yuri Silveira
                        neighborhood: Marginal Theo
                        complement: Autumn Court
                        number: '47854'
                        reference: South
                        cep: 44900-000
                      relationships:
                        cities:
                          data:
                            id: '1'
                            type: cities
                    - id: '1'
                      type: cities
                      attributes:
                        name: Vila Lângaro
                        capital: false
                      relationships:
                        states:
                          data:
                            id: '1'
                            type: states
                    - id: '1'
                      type: states
                      attributes:
                        name: Piauí
                        acronym: BA
        '422':
          description: create failt
          content:
            application/json:
              schema:
                type: object
                properties:
                  name:
                    type: array
                    items:
                      type: string
                      example: não pode ser vázio
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                restaurant:
                  type: object
                  properties:
                    name:
                      type: string
                      example: Viana LTDA
                    active:
                      type: boolean
                    phones_attributes:
                      type: array
                      items:
                        type: object
                      example:
                      - number: 11-9999-9999
                      - id: 1
                        number: 11-9999-9999
                      - id: 2
                        _destroy: true
                    address_attributes:
                      type: object
                      properties:
                        street:
                          type: string
                          example: Travessa Meire
                        neighborhood:
                          type: string
                          example: Center
                        complement:
                          type: string
                          example: Willow Gardens
                        number:
                          type: string
                          example: '8776'
                        reference:
                          type: string
                        cep:
                          type: string
                          example: 44900-000
                      required:
                      - street
                      - cep
                      - neighborhood
              required:
              - name
              - active
    get:
      summary: show restaurant
      tags:
      - Restaurants
      security:
      - bearer: []
      parameters:
      - name: id
        in: path
        required: true
        schema:
          type: string
      - name: included
        in: query
        required: false
        example: phones,address,address.city,address.city.state
        schema:
          type: string
      responses:
        '200':
          description: found
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    "$ref": "#/components/schemas/restaurant"
        '404':
          description: not found
          content: {}
  "/v1/owners/restaurants/availability_slug":
    put:
      summary: check slug availability
      tags:
      - Restaurants
      security:
      - bearer: []
      parameters: []
      responses:
        '202':
          description: availability
          content: {}
        '422':
          description: availability
          content:
            application/json:
              schema:
                type: object
                properties:
                  slug:
                    type: array
                    items:
                      type: string
                      example:
                      - já está em uso
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                restaurant:
                  type: object
                  properties:
                    slug:
                      type: string
                      example: doloremque-tenetur
              required:
              - name
              - active
  "/v1/owners/sessions":
    post:
      summary: Login
      tags:
      - Sessions
      parameters: []
      responses:
        '201':
          description: login success
          content:
            application/json:
              schema:
                type: object
                properties:
                  token:
                    type: string
                    example: xxxxx
                required:
                - token
        '422':
          description: login fail
          content:
            application/json:
              schema:
                type: object
                properties:
                  password:
                    type: array
                    items:
                      type: string
                      example: Senha incorreta
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                login:
                  type: object
                  properties:
                    email:
                      type: string
                      example: ching.bartoletti@ward-lindgren.name
                    password:
                      type: string
                      example: '12345678'
              required:
              - email
              - password
  "/v1/owners/sessions/me":
    delete:
      summary: Destroy session
      tags:
      - Sessions
      security:
      - bearer: []
      responses:
        '204':
          description: login success
          content: {}
        '401':
          description: when owner is not logged in
          content: {}
  "/v1/owners":
    post:
      summary: Creates a owner
      tags:
      - Owners
      parameters: []
      responses:
        '201':
          description: owner created
          content:
            application/json:
              schema:
                type: object
                properties:
                  token:
                    type: string
                    example: xxxxx
                required:
                - token
        '422':
          description: owner created fail
          content:
            application/json:
              schema:
                type: object
                properties:
                  email:
                    type: array
                    items:
                      type: string
                      example: Email inválido
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                owner:
                  type: object
                  properties:
                    email:
                      type: string
                      example: gricelda_witting@prohaska.org
                    password:
                      type: string
                      example: '12345678'
                    password_confirmation:
                      type: string
                      example: '12345678'
              required:
              - email
              - password
              - password_confirmation
  "/v1/owners/me":
    get:
      summary: Show me
      tags:
      - Owners
      security:
      - bearer: []
      responses:
        '200':
          description: get me
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    "$ref": "#/components/schemas/owner"
    put:
      summary: Update me
      tags:
      - Owners
      security:
      - bearer: []
      description: to update email or password the current password is required ...
        use the password_current field
      parameters: []
      responses:
        '202':
          description: update email
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    "$ref": "#/components/schemas/owner"
        '422':
          description: owner update fail
          content:
            application/json:
              schema:
                type: object
                properties:
                  email:
                    type: array
                    items:
                      type: string
                      example: não pode ser vázio
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                owner:
                  type: object
                  properties:
                    email:
                      type: string
                      example: miguel.marvin@fahey-hayes.co
                    password:
                      type: string
                      example: '12345678'
                    password_confirmation:
                      type: string
                      example: '12345678'
                    password_current:
                      type: string
                      example: '12345678'
                      description: Only needed to update sensitive data
                  required:
                  - email
    delete:
      summary: Delete me
      tags:
      - Owners
      security:
      - bearer: []
      responses:
        '204':
          description: destroy success
          content: {}
  "/v1/recover_password/{model}":
    post:
      summary: ''
      tags:
      - RecoverPassword
      parameters:
      - name: model
        in: path
        example: owner
        required: true
        schema:
          type: string
      responses:
        '201':
          description: send request update password
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Confira sua caixa de email
        '422':
          description: when model not found
          content:
            application/json:
              schema:
                type: object
                properties:
                  errors:
                    type: object
                    properties:
                      email:
                        type: string
                        example: Email não encontrado
        '404':
          description: not found model
          content: {}
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                recover:
                  type: object
                  properties:
                    email:
                      type: string
                      example: meg@breitenberg.biz
                  required:
                  - email
  "/v1/recover_password/{model}/{id}":
    put:
      summary: when update password
      tags:
      - RecoverPassword
      security:
      - bearer: []
      parameters:
      - name: model
        in: path
        example: owner
        required: true
        schema:
          type: string
      - name: id
        in: path
        example: me
        required: true
        schema:
          type: string
      responses:
        '202':
          description: update success
          content: {}
        '422':
          description: update fail
          content:
            application/json:
              schema:
                type: object
                properties:
                  password_confirmation:
                    type: array
                    items:
                      type: string
                      example: não corresponde Password
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                recover:
                  type: object
                  properties:
                    password:
                      type: string
                      example: '12345678'
                    password_con:
                      type: string
                      example: '12345678'
                  required:
                  - password
                  - password_confirmation
components:
  schemas:
    tools_whatsapp:
      type: object
      properties:
        data:
          type: object
          properties:
            type:
              type: string
              example: tool_whatsapps
            attributes:
              type: object
              properties:
                active:
                  type: boolean
                created_at:
                  type: datetime
                  example: '2020-09-23 16:23:00 -0300'
                updated_at:
                  type: datetime
                  example: '2020-09-23 16:23:00 -0300'
            relationships:
              type: object
              properties:
                phones:
                  type: object
                  properties:
                    data:
                      type: array
                      items:
                        type: object
                      example:
                      - id: '1'
                        type: phones
        included:
          type: array
          items:
            type: object
          example:
          - id: '1'
            type: phones
            attributes:
              number: 11-9999-9999
            relationships:
              data:
                restaurants:
                  data:
                    id: '1'
                    type: restaurants
          - id: '1'
            type: restaurants
            attributes:
              name: da Penha S.A.
              slug: odio-quasi
    phone:
      type: object
      properties:
        id:
          type: string
          example: '1'
        type:
          type: string
          example: phones
        attributes:
          type: object
          properties:
            number:
              type: string
    owner:
      type: object
      properties:
        id:
          type: string
          example: '1'
        type:
          type: string
          example: owners
        attributes:
          type: object
          properties:
            email:
              type: string
              example: todd_schuster@beier-greenholt.name
            name:
              type: string
              nullable: true
            login_count:
              type: integer
              example: 1
            created_at:
              type: string
              example: '2020-09-23 16:23:00 -0300'
            updated_at:
              type: string
              example: '2020-09-23 16:23:00 -0300'
          required:
          - email
          - login_count
    product:
      type: object
      properties:
        id:
          type: string
          example: '1'
        type:
          type: string
          example: products
        attributes:
          type: object
          properties:
            price:
              type: string
              example: '10.0'
            name:
              type: string
              example: Teriyaki Chicken Donburi
            description:
              type: string
              example: Culver’s Restaurant was founded by the Culver family in 1984,
                which eventually branched out to more than 300 franchised restaurants
                all over the US. Culver’s is well-known for its ButterBurger, which
                made the restaurant extremely famous. They also have other items which
                include salads, sandwiches, desserts, etc.
              nullable: true
            position:
              type: integer
              example: 0
              nullable: true
            active:
              type: boolean
            image:
              type: object
              nullable: true
              properties:
                original:
                  type: string
                  example: https://loremflickr.com/300/300
                small:
                  type: string
                  example: https://loremflickr.com/300/300
          required:
          - price
          - name
    section:
      type: object
      properties:
        id:
          type: string
        type:
          type: string
          example: sections
        attributes:
          type: object
          properties:
            name:
              type: string
              example: Drinks
            position:
              type: integer
              example: 1
            active:
              type: boolean
    restaurant:
      type: object
      properties:
        type:
          type: string
          example: restaurants
        id:
          type: string
        attributes:
          type: object
          properties:
            name:
              type: string
            slug:
              type: string
            products_remaining:
              type: integer
              example: 1
            active:
              type: boolean
          required:
          - name
          - slug
          - active
        relationships:
          type: object
          properties:
            sections:
              type: object
              properties:
                data:
                  type: array
                  items:
                    properties:
                      id:
                        type: string
                      type:
                        type: string
                        example: phones
  securitySchemes:
    bearer:
      type: http
      scheme: bearer
servers:
- url: http://localhost:3000
  variables:
    defaultHost:
      default: http://localhost:3000
- url: https://imenu-dev.herokuapp.com
  variables:
    defaultHost:
      default: https://imenu-dev.herokuapp.com
- url: https://iume-api-stage.herokuapp.com
  variables:
    defaultHost:
      default: https://iume-api-stage.herokuapp.com
